<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åœ¨çº¿ç”ŸæˆVNTé…ç½®æ–‡ä»¶ ğŸ’•</title>
<style>
body {
  font-family: 'Comic Sans MS', 'Microsoft YaHei', sans-serif;
  background-color: #fff5f9;
  color: #333;
  margin: 0;
  padding: 0;
}
.container {
  max-width: 900px;
  margin: 2em auto;
  background: #fff;
  border-radius: 20px;
  box-shadow: 0 0 15px rgba(255, 182, 193, 0.5);
  padding: 2em;
}
h1 {
  text-align: center;
  color: #ff66a3;
  font-weight: bold;
  margin-bottom: 1em;
}
label {
  display: block;
  margin-top: 1em;
  font-weight: bold;
  color: #ff4d88;
}
input, select, textarea {
  width: 100%;
  padding: 0.6em;
  border-radius: 10px;
  border: 1px solid #ffb6c1;
  margin-top: 0.3em;
  font-size: 15px;
}
button {
  background-color: #ff85c0;
  color: white;
  border: none;
  padding: 0.6em 1.2em;
  border-radius: 15px;
  margin-top: 1em;
  cursor: pointer;
  font-size: 1em;
  transition: 0.2s;
}
button:hover {
  background-color: #ff5ea8;
}
.section-title {
  background-color: #ffe6ef;
  padding: 0.6em 1em;
  border-radius: 12px;
  color: #ff66a3;
  margin-top: 1.5em;
  font-weight: bold;
}
textarea#yamlOutput {
  height: 300px;
  background: #fff0f5;
  border: 1px solid #ffc6d9;
  margin-top: 1em;
}
.actions {
  text-align: center;
  margin-top: 1em;
}

</style>
</head>
<body>
<div class="container">
  <h1>ğŸŒ¸ VNT config.yaml ç”Ÿæˆå™¨ ğŸŒ¸</h1>

  <div class="section-title">âœ¨ åŸºæœ¬ (å¿…~éœ€~çš„~~~)</div>
  <label>Tokenï¼ˆç»„ç½‘æ ‡è¯†ï¼‰</label>
  <input type="text" id="token" placeholder="å¿…å¡«ï¼šç›¸åŒ token çš„è®¾å¤‡ç»„æˆåŒä¸€å±€åŸŸç½‘">

  <label>æœåŠ¡å™¨åœ°å€ä¸ç«¯å£</label>
<div style="display:flex;gap:0.5em;align-items:center;">
  <select id="protocol" style="width:70px;text-align:center;">
    <option value="udp">udp://</option>
    <option value="tcp">tcp://</option>
    <option value="ws" selected>ws://</option>
    <option value="wss">wss://</option>
  </select>
  <input type="text" id="server_address" placeholder="æœåŠ¡å™¨åŸŸåæˆ–IP" style="flex:1;">
  <input type="text" id="server_port" placeholder="ç«¯å£å·" value="29872" style="width:90px;text-align:center;">
</div>


  <label>æ¥å£ IP åœ°å€ï¼ˆipï¼‰</label>
  <input type="text" id="ip" placeholder="æ¯ä¸ªå®¢æˆ·ç«¯çš„æ¥å£IPä¸èƒ½ç›¸åŒ">

<label>è®¾å¤‡ IDï¼ˆdevice_idï¼‰</label>
<div style="display:flex;align-items:center;gap:0.5em;">
  <input type="text" id="device_id" placeholder="å”¯ä¸€æ ‡è¯†ï¼Œæ¯å°è®¾å¤‡ä¸åŒ" style="flex:1;">
  <button type="button" id="genUUID" style="margin-top:0;">éšæœºUUID</button>
</div>




  <div class="section-title">ğŸ’¡ é«˜çº§ (æŒ‰éœ€)</div>
  <label>è®¾å¤‡åç§°ï¼ˆnameï¼‰</label>
  <input type="text" id="name" placeholder="æ–¹ä¾¿åŒºåˆ†ä¸åŒè®¾å¤‡">

  <label>STUN æœåŠ¡å™¨</label>
  <textarea id="stun_server" rows="5" placeholder="æ¯è¡Œä¸€ä¸ªï¼Œä¾‹å¦‚ï¼šstun.miwifi.com"></textarea>

  <label>DNS æœåŠ¡å™¨</label>
  <textarea id="dns" rows="5" placeholder="æ¯è¡Œä¸€ä¸ªï¼Œä¾‹å¦‚ï¼š1.1.1.1"></textarea>

  <label>æ‰“æ´æ¨¡å¼ï¼ˆpunch_modelï¼‰</label>
  <select id="punch_model">
    <option value="all" selected>éšæœºåº”å˜</option>
    <option value="ipv4">ipv4</option>
    <option value="ipv6">ipv6</option>
  </select>

  <label>ä¼ è¾“æ¨¡å¼ï¼ˆuse_channelï¼‰</label>
  <select id="use_channel">
    <option value="all" selected>éšæœºåº”å˜</option>
    <option value="relay">ä»…ä¸­ç»§</option>
    <option value="p2p">ä»…ç›´è¿</option>
  </select>
    
	<label>åŠ å¯†æ¨¡å¼ï¼ˆcipher_modelï¼‰</label>
  <select id="cipher_model">
    <option value="off">offï¼ˆä¸åŠ å¯†ï¼‰</option>
    <option value="aes_ecb">aes_ecb</option>
	<option value="sm4_cbc">sm4_cbc</option>
	<option value="aes_cbc">aes_cbc</option>
    <option value="chacha20" >chacha20</option>
    <option value="aes_gcm" selected>aes_gcm (X86è®¾å¤‡é¦–é€‰)</option>
    <option value="chacha20_poly1305">chacha20_poly1305 (ARMè®¾å¤‡é¦–é€‰)</option>
    <option value="xor">xor</option>
  </select>
  
  <label>åŠ å¯†å¯†é’¥ï¼ˆpasswordï¼‰</label>
  <input type="text" id="password" placeholder="å¼€å¯åŠ å¯†æ¨¡å¼åå¡«å†™">

  <label>æœåŠ¡ç«¯åŠ å¯†ï¼ˆserver_encryptï¼‰</label>
  <select id="server_encrypt">
    <option value="false">false (å…³)</option>
    <option value="true" selected>true (å¼€)</option>
  </select>

  <label>å‹ç¼©ç®—æ³•ï¼ˆcompressorï¼‰</label>
  <select id="compressor">
    <option value="none">none(ä¸åŠ å¯†)</option>
    <option value="lz4" selected>lz4</option>
    <option value="zstd">zstd(éœ€è‡ªè¡Œç¼–è¯‘)</option>
  </select>

  <div class="section-title">ğŸ€ æ›´é«˜çº§ (ä¸€èˆ¬ä¸å¡«)</div>
  <label>MTU</label>
  <input type="text" id="mtu" placeholder="é»˜è®¤ç•™ç©ºä½¿ç”¨è‡ªåŠ¨å€¼">



  <label>æ˜ å°„ï¼ˆmappingï¼‰</label>
  <textarea id="mapping" rows="5" placeholder="ä¾‹å¦‚ï¼štcp:0.0.0.0:80->10.26.0.10:81"></textarea>

  <label>ä¸¢åŒ…ç‡ï¼ˆpacket_lossï¼‰</label>
  <input type="text" id="packet_loss" placeholder="0~1ä¹‹é—´çš„å€¼ï¼Œç”¨äºæµ‹è¯•">

  <label>å»¶è¿Ÿï¼ˆpacket_delayï¼‰</label>
  <input type="text" id="packet_delay" placeholder="å•ä½ï¼šæ¯«ç§’">

  <div class="actions">
    <button type="button" onclick="generateYAML()">âœ¨ ç”Ÿæˆ config.yaml</button>
    <button type="button" onclick="copyYAML()">ğŸ“‹ å¤åˆ¶</button>
    <button type="button" onclick="downloadYAML()">ğŸ’¾ ä¸‹è½½</button>
  </div>

  <label>ç”Ÿæˆç»“æœï¼š</label>
  <textarea id="yamlOutput" readonly placeholder="ç”Ÿæˆçš„ config.yaml å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ"></textarea>
</div>

<script>
function generateUUID() {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
    const r = Math.random() * 16 | 0;
    const v = c === 'x' ? r : (r & 0x3 | 0x8);
    return v.toString(16);
  });
}

document.getElementById('genUUID').onclick = function() {
  document.getElementById('device_id').value = generateUUID();
};

function generateYAML() {
  const getVal = id => document.getElementById(id).value.trim();
  const getList = id => getVal(id).split(/\n+/).filter(Boolean);

  const data = {
    token: getVal('token'),
    name: getVal('name'),
    ip: getVal('ip'),
    device_id: getVal('device_id'),
    server_address: `${getVal('protocol')}://${getVal('server_address')}:${getVal('server_port')}`,
    stun_server: getList('stun_server'),
    dns: getList('dns'),
    mtu: getVal('mtu'),
    password: getVal('password'),
    mapping: getList('mapping'),
    packet_loss: getVal('packet_loss'),
    packet_delay: getVal('packet_delay'),
    punch_model: getVal('punch_model'),
    use_channel: getVal('use_channel'),
    cipher_model: getVal('cipher_model'),
	server_encrypt: getVal('server_encrypt'),
    compressor: getVal('compressor')
  };

  let yaml = '# VNT config.yaml è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶\n# https://github.com/xiaoheinewbie/vnt-config-web\n#\n';
  for (const [key, val] of Object.entries(data)) {
    if (!val || (Array.isArray(val) && val.length === 0)) continue;
    switch (key) {
      case 'token': yaml += `token: ${val} # ç»„ç½‘ Token\n`; break;
      case 'server_address': yaml += `server_address: ${val} # æ³¨å†Œå’Œä¸­ç»§æœåŠ¡å™¨\n`; break;
      case 'ip': yaml += `ip: ${val} # æ¥å£ IP åœ°å€\n`; break;
      case 'device_id': yaml += `device_id: ${val} # è®¾å¤‡ ID\n`; break;
      case 'name': yaml += `name: ${val} # è®¾å¤‡åç§°\n`; break;
      case 'stun_server': yaml += 'stun_server: # STUN æœåŠ¡å™¨\n' + val.map(v => `  - ${v}\n`).join(''); break;
      case 'dns': yaml += 'dns: # DNS æœåŠ¡å™¨\n' + val.map(v => `  - ${v}\n`).join(''); break;
      case 'mtu': yaml += `mtu: ${val} # MTU å€¼\n`; break;
      case 'password': yaml += `password: ${val} # åŠ å¯†å¯†é’¥\n`; break;
      case 'mapping': yaml += 'mapping: # ç«¯å£æ˜ å°„\n' + val.map(v => `  - ${v}\n`).join(''); break;
      case 'packet_loss': yaml += `packet_loss: ${val} # æ¨¡æ‹Ÿä¸¢åŒ…ç‡\n`; break;
      case 'packet_delay': yaml += `packet_delay: ${val} # æ¨¡æ‹Ÿå»¶è¿Ÿ(æ¯«ç§’)\n`; break;
      case 'punch_model': yaml += `punch_model: ${val} # æ‰“æ´æ¨¡å¼\n`; break;
      case 'use_channel': yaml += `use_channel: ${val} # ä¼ è¾“æ¨¡å¼\n`; break;
      case 'cipher_model': yaml += `cipher_model: ${val} # åŠ å¯†æ¨¡å¼\n`; break;
	  case 'server_encrypt': yaml += `server_encrypt: ${val} # æœåŠ¡ç«¯åŠ å¯†\n`; break;
      case 'compressor': yaml += `compressor: ${val} # å‹ç¼©ç®—æ³•\n`; break;
    }
  }
  document.getElementById('yamlOutput').value = yaml;
}

function copyYAML() {
  const text = document.getElementById('yamlOutput').value;
  if (!text) return alert('è¯·å…ˆç”Ÿæˆé…ç½®');
  navigator.clipboard.writeText(text);
  alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
}

function downloadYAML() {
  const text = document.getElementById('yamlOutput').value;
  if (!text) return alert('è¯·å…ˆç”Ÿæˆé…ç½®');
  const blob = new Blob([text], { type: 'text/yaml' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'config.yaml';
  a.click();
}
</script>
</body>
</html>
